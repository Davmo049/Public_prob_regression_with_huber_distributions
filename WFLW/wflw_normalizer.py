import numpy as np
import scipy.linalg
import torch

wflw_mean = np.array([[46.52917760513182, 90.04791221953573],
[47.01282024970793, 98.77795977790015],
[47.506400172545796, 107.51295404084523],
[48.17920553574321, 116.22511720257714],
[49.231578563295656, 124.89188965734981],
[50.80535446679024, 133.47588848749797],
[53.009658756085805, 141.90735340917678],
[55.956311836197266, 150.0851149757022],
[59.72760208945047, 157.88917678469704],
[64.31611377485594, 165.21071115838913],
[69.61570130534399, 171.99699800182523],
[75.47921373692013, 178.24798699515208],
[81.81207497109686, 183.98074928792317],
[88.56993604636192, 189.1036587916783],
[95.89318417201156, 193.29783395095097],
[103.93739740212759, 196.03354353841146],
[112.46095681117829, 196.86898197137742],
[120.96045488575527, 195.9256903090704],
[128.94862918781098, 193.0909264846075],
[136.1905367126465, 188.80192577834356],
[142.85236909412203, 183.5913392944336],
[149.09994309493473, 177.78700870332264],
[154.9037320387704, 171.48832090468633],
[160.1555106128511, 164.6789826711019],
[164.70796838814871, 157.3443318634033],
[168.44621090843563, 149.53064448474703],
[171.34458222743444, 141.33547856140137],
[173.4837729056222, 132.88442465500606],
[174.98092716761997, 124.28096469216119],
[175.95638028390067, 115.5965407733009],
[176.5624376540411, 106.87306134223938],
[176.99405500866118, 98.13289626471202],
[177.40140846470425, 89.39828678191276],
[63.069429225932986, 81.18710838406426],
[71.71110109474829, 73.4347350902529],
[81.02607480153583, 72.65808259637015],
[90.38980941082183, 73.76404148571832],
[99.56373247446332, 76.03267774734043],
[99.56127428636097, 81.83684641263882],
[90.40887111663818, 80.01426181647324],
[81.05858681092944, 78.89307883544195],
[71.78059796133496, 79.2247381724403],
[123.77530904388428, 75.79738992911294],
[132.88232524944488, 73.47064915883541],
[142.19461553664433, 72.25594644737244],
[151.52676454598563, 72.93663026836373],
[160.29231080336797, 80.63167363528127],
[151.5137832103911, 78.73001405316307],
[142.22115881202333, 78.50191811752887],
[132.91686718132382, 79.71600949083056],
[123.8187809916905, 81.60674012835821],
[111.7401256762005, 92.11023345147996],
[111.76636320659092, 103.76426518503825],
[111.79011041445959, 115.36702130926223],
[111.8130385576884, 126.37313953908284],
[97.73322316810064, 131.94104069591702],
[104.7420719325656, 133.49924516805012],
[111.87333622414725, 134.8080498853411],
[119.02786814144679, 133.43878058079312],
[126.06347242773147, 131.81353303673154],
[72.11569261896042, 92.94374372654869],
[77.38969025959287, 89.69825568562462],
[83.5460354788644, 88.32437795986732],
[90.67125532041277, 89.45910710990997],
[96.2488039268312, 93.85400152542478],
[90.02935678445725, 95.77480513872419],
[83.44503766468593, 96.36411290722802],
[77.51298246549425, 95.40793138077146],
[127.19132299659366, 93.64774786145347],
[132.7815147458031, 89.1733633594513],
[139.95623921893892, 87.9663205537796],
[146.07503584725515, 89.2843983363339],
[151.33214160519555, 92.48197817017919],
[146.06672192455474, 94.97825598607744],
[140.2349964472453, 96.00858728765306],
[133.54886074356807, 95.50708783054351],
[86.92411448537736, 151.9774120846703],
[96.2088992009844, 147.80654068865095],
[107.10389240192232, 146.21590136282785],
[111.95732815860566, 146.32752366638184],
[116.83276493124735, 146.13835343133834],
[127.77532952771868, 147.63531905764626],
[137.08438552129837, 151.74881701660155],
[130.69373226656234, 158.96504111662364],
[122.26175306292943, 164.32096134440104],
[112.16610772278196, 166.15269945853098],
[102.00121515604428, 164.42980341738746],
[93.44072901328973, 159.17960717482794],
[88.83390282617296, 152.34775489589146],
[100.05551002375284, 150.92396488226026],
[112.00290021383195, 150.97832556370327],
[123.92609166081746, 150.82970522562664],
[135.1936054763794, 152.0890964784168],
[124.45037253193628, 156.85905509585427],
[112.10102251155035, 158.7400355922154],
[99.651038959594, 157.00574158514112],
[84.06862319165184, 92.28240817851112],
[139.5384976279849, 91.9661992545355]], dtype=np.float64)

wflw_half_prec = np.array([[[0.055306709185023506, 0.005093628370240785],
  [0.005093628370240811, 0.03482407225327387]],
[[0.0583160674745621, 0.003117322678976836],
  [0.003117322678976836, 0.035079382621551934]],
[[0.06031702651358324, 0.000639227700044212],
  [0.000639227700044246, 0.03541121872143573]],
[[0.061067384831370745, -0.0021608011772678757],
  [-0.00216080117726791, 0.03598878663013644]],
[[0.06044946045006343, -0.004992281969888694],
  [-0.0049922819698886576, 0.036935342716748754]],
[[0.0585789516934066, -0.007526894827526101],
  [-0.007526894827526173, 0.03827087256048115]],
[[0.05574996928627013, -0.009531357028357852],
  [-0.009531357028357852, 0.039935335652418975]],
[[0.05236773791366838, -0.010941100841954682],
  [-0.010941100841954684, 0.0418710189698343]],
[[0.04877524687616603, -0.011764813069804302],
  [-0.0117648130698043, 0.044029390862168075]],
[[0.04513429037000558, -0.011980451604212256],
  [-0.011980451604212202, 0.04630686896794253]],
[[0.04152964235296061, -0.011561692588330336],
  [-0.011561692588330286, 0.04850488320877127]],
[[0.0380726349012174, -0.010563560595755046],
  [-0.010563560595755046, 0.05042438224046339]],
[[0.0348824175958236, -0.009063890325870422],
  [-0.00906389032587042, 0.051887702107932455]],
[[0.032051191150595675, -0.007151474770671799],
  [-0.0071514747706717995, 0.052769976365600296]],
[[0.029744697223952503, -0.004921697124002726],
  [-0.004921697124002809, 0.053112840902108195]],
[[0.028185193244698526, -0.0024642395428681185],
  [-0.0024642395428681185, 0.053119020960327744]],
[[0.027511903994482032, 0.00012181650059393123],
  [0.00012181650059385633, 0.05296698576146643]],
[[0.02818570040771611, 0.0027335202028930727],
  [0.002733520202893152, 0.05317934157664415]],
[[0.029771940298553692, 0.005256356148419059],
  [0.005256356148419061, 0.05325362822704565]],
[[0.03212018455397544, 0.007563627504585164],
  [0.007563627504585168, 0.05298794894788169]],
[[0.03500207110683707, 0.009539757177033745],
  [0.009539757177033746, 0.0521273913749788]],
[[0.038271254116315864, 0.011128859136937964],
  [0.011128859136937754, 0.050692980367910145]],
[[0.04186250230226436, 0.01225306575193601],
  [0.012253065751936234, 0.048819587996048866]],
[[0.04567732635235794, 0.012800062505523102],
  [0.012800062505522862, 0.04663502238694155]],
[[0.049564842903075494, 0.012691612393345295],
  [0.012691612393345545, 0.044330343777903077]],
[[0.05339933835306144, 0.011932520458332187],
  [0.011932520458332185, 0.04210789948247768]],
[[0.05697666136908069, 0.01053832468402348],
  [0.01053832468402334, 0.04008959681501864]],
[[0.059901885144831, 0.008502241452301294],
  [0.008502241452301294, 0.03832111401838899]],
[[0.06173525394859298, 0.005899711348403493],
  [0.005899711348403346, 0.03687126172166184]],
[[0.062157990762438387, 0.0029778613033930716],
  [0.0029778613033929285, 0.035813328046223884]],
[[0.061114462160302994, 8.480287406793329e-05],
  [8.48028740679333e-05, 0.035134523515101754]],
[[0.058830587716747665, -0.0024700006310557723],
  [-0.0024700006310557714, 0.03471631623406915]],
[[0.055551402000538375, -0.004496624852601203],
  [-0.004496624852601202, 0.034402725571100676]],
[[0.04824438036927663, 0.006645517442597731],
  [0.00664551744259773, 0.04352174860022259]],
[[0.044636803067964054, 0.006992491878254319],
  [0.006992491878254319, 0.04714696096698404]],
[[0.043184450123621355, 0.006271143506772349],
  [0.006271143506772384, 0.05076432150098129]],
[[0.04200091640091408, 0.004887142885062063],
  [0.004887142885061994, 0.05388456529806061]],
[[0.040932729447519335, 0.003095093588295813],
  [0.0030950935882957387, 0.056006051981165]],
[[0.04260996581191451, 0.0026574558896780773],
  [0.002657455889678076, 0.05765407639864025]],
[[0.043996936019206775, 0.00440712264568387],
  [0.004407122645683872, 0.055257314242800296]],
[[0.04533539852978353, 0.0057709092109962425],
  [0.005770909210996166, 0.05169321821129379]],
[[0.0467121712503461, 0.006465244730177578],
  [0.006465244730177582, 0.047638435286410874]],
[[0.040752625832556205, -0.0024747581262151526],
  [-0.002474758126215152, 0.055629513006033596]],
[[0.04170440959440325, -0.004298475529787874],
  [-0.004298475529787876, 0.05296677215350525]],
[[0.04278493760099305, -0.0056724949172301045],
  [-0.0056724949172301045, 0.04950023702640567]],
[[0.04409837361519736, -0.006286352139473545],
  [-0.006286352139473545, 0.045693795117646416]],
[[0.047518322618460916, -0.005864918119978414],
  [-0.005864918119978413, 0.042168922815298215]],
[[0.04617375984287608, -0.005794920902988413],
  [-0.005794920902988413, 0.04617723663648369]],
[[0.0449119265769614, -0.005192248600703331],
  [-0.00519224860070333, 0.05037545138200252]],
[[0.04371594495521243, -0.0038188165645136425],
  [-0.0038188165645136407, 0.05434389945704313]],
[[0.04246079332616575, -0.0020317179995798405],
  [-0.002031717999579839, 0.057196917860737675]],
[[0.04406911205352412, 0.00038695023768028924],
  [0.0003869502376802894, 0.0631157611235218]],
[[0.04268354203227994, 0.00027638520640539915],
  [0.0002763852064053024, 0.06283216903599284]],
[[0.03988038846154198, 0.00017361254104065923],
  [0.00017361254104065918, 0.06032368876356527]],
[[0.03697897666714509, 6.107512808859017e-05],
  [6.10751280885902e-05, 0.056521015745662415]],
[[0.04492491842665802, -0.0025252239156493715],
  [-0.0025252239156495783, 0.06251086947618162]],
[[0.04315542331024625, -0.000824029809137032],
  [-0.000824029809137032, 0.06342005240279096]],
[[0.04156415154932769, 0.00020240685626908675],
  [0.00020240685626908675, 0.06295209094585234]],
[[0.04312814028676642, 0.001127736551665319],
  [0.0011277365516655176, 0.06320232142758604]],
[[0.0448777595400412, 0.002679634656430653],
  [0.0026796346564306513, 0.06221215674599495]],
[[0.05246984318317896, 0.004528980124044463],
  [0.004528980124044463, 0.04913425966233998]],
[[0.05047029857970112, 0.0047521024976225935],
  [0.004752102497622602, 0.051632046973385956]],
[[0.048961877448037, 0.004487450882486137],
  [0.004487450882486134, 0.054618534683415036]],
[[0.0500835612807951, 0.003754732920600587],
  [0.0037547329206005873, 0.05890316474875993]],
[[0.05202301371189452, 0.002584737628179018],
  [0.0025847376281790168, 0.06256955098008263]],
[[0.05237974242184234, 0.003023568549665715],
  [0.003023568549665591, 0.059526351399059846]],
[[0.051691444864766456, 0.0032137120692114743],
  [0.0032137120692114743, 0.055494599317909975]],
[[0.05248293896186199, 0.0037559335710401643],
  [0.0037559335710401643, 0.052153303770656655]],
[[0.05150884741173958, -0.0019457038027364656],
  [-0.0019457038027365925, 0.061854965254473426]],
[[0.04966617439298839, -0.0031848563165593102],
  [-0.003184856316559203, 0.05798396581399946]],
[[0.04860241459316052, -0.0038646074217846935],
  [-0.003864607421784694, 0.053636285829741705]],
[[0.04991694002180485, -0.0041208964252577645],
  [-0.004120896425257769, 0.050666466649771626]],
[[0.05169199892190346, -0.003886428798201015],
  [-0.0038864287982010113, 0.04820736713322761]],
[[0.05190037591601991, -0.003006263723218127],
  [-0.0030062637232181277, 0.05125142657558003]],
[[0.05134493935287841, -0.0023337688913951946],
  [-0.0023337688913952024, 0.05462648867879391]],
[[0.05190660468251496, -0.0021739892925923135],
  [-0.0021739892925924324, 0.05877371372650136]],
[[0.044607801665387185, -0.007809866300503703],
  [-0.007809866300503701, 0.05998725519813976]],
[[0.042927581330597035, -0.004509908146899195],
  [-0.004509908146899197, 0.06212197996483914]],
[[0.039597972700149545, -0.0009956352278279869],
  [-0.000995635227827987, 0.06231271040179769]],
[[0.03945645333763886, 5.983976923288929e-05],
  [5.98397692328893e-05, 0.062261032314377594]],
[[0.03963909668415312, 0.0010470090479782757],
  [0.001047009047978444, 0.062084872563573916]],
[[0.042898633240633935, 0.004719443751448403],
  [0.004719443751448403, 0.06184736912405941]],
[[0.044798113380531523, 0.008298979947448106],
  [0.008298979947448106, 0.05994456605436986]],
[[0.0404613942153988, 0.006595775448538277],
  [0.006595775448538277, 0.06237297769689947]],
[[0.0366674686964973, 0.003569648813698],
  [0.0035696488136980004, 0.06247534760158786]],
[[0.03473584956026134, 0.00026456829998173197],
  [0.000264568299981732, 0.0616423421766892]],
[[0.03664121180589918, -0.00298772873356215],
  [-0.0029877287335621497, 0.06234804170356151]],
[[0.04033522763277741, -0.0059927425327362775],
  [-0.0059927425327362775, 0.0623132407658077]],
[[0.04460007179125622, -0.007565535376978081],
  [-0.007565535376978079, 0.06117230043594718]],
[[0.041966084968042515, -0.003656788186841079],
  [-0.003656788186841079, 0.06259720065233297]],
[[0.0386434826994472, 2.2767896260354897e-05],
  [2.276789626035489e-05, 0.061534323999838804]],
[[0.041920985428245114, 0.0038488276880777796],
  [0.0038488276880777796, 0.06236134801292822]],
[[0.04468022498401683, 0.008054930817121317],
  [0.008054930817121123, 0.0610693298907504]],
[[0.04013193187120329, 0.004527143531598833],
  [0.004527143531598833, 0.06489896687749486]],
[[0.037015797318336124, 0.0003337511884671169],
  [0.0003337511884671169, 0.06409136868314129]],
[[0.040088225505508994, -0.0038122796176436424],
  [-0.0038122796176436424, 0.06484795165111568]],
[[0.05151583813953296, 0.0038251696989812945],
  [0.003825169698981294, 0.05586048789240453]],
[[0.05120714112862053, -0.0032874768145341625],
  [-0.003287476814534163, 0.054918498135784435]]], dtype=np.float64)
